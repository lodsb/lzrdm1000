<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
  <meta http-equiv="CONTENT-TYPE"
 content="text/html; charset=iso-8859-1">
  <title>JJack - Java framework for the JACK Audio Connection Kit</title>
  <meta name="GENERATOR" content="OpenOffice.org 1.0  (Linux)">
  <meta name="AUTHOR" content="Jens Gulden">
  <meta content="Jens Gulden" name="author">
</head>
<body lang="de-DE">
<h1><a name="mozTocId160097" class="mozTocH1"></a>JJack - Java
framework API for the JACK Audio Connection Kit<br>
</h1>
<p style="margin-bottom: 0cm;">
  JJack is a <a href="http://www.jackaudio.org/">JACK</a> audio driver
  for the <a href="http://java.sun.com/products/java-media/sound/">Java Sound API</a>
  and a framework for the <a href="http://java.sun.com/">Java programming language</a>
  that allows Java applications to use the
  <a href="http://www.jackaudio.org/">JACK Audio Connection Kit</a>.<br>
</p>
<p style="margin-bottom: 0cm;">Copyright &copy; Jens
Gulden<span style="text-decoration: none;"></span>.<br>
Licensed under the <a href="http://www.gnu.org/licenses/lgpl.html"
 target="_blank">GNU
Lesser General Public License (LGPL)</a>.</p>
<p style="margin-bottom: 0cm;">This software comes with NO WARRANTY.
See file <a href="../LICENSE">LICENSE</a> for details.</p>
<hr>
<div id="Inhaltsverzeichnis1"
 style="background: transparent none repeat scroll 0% 50%; -moz-background-clip: initial; -moz-background-origin: initial; -moz-background-inline-policy: initial;">
<div id="Inhaltsverzeichnis1_Head">
<p style="margin-top: 0.42cm; page-break-after: avoid;"><font
 face="Albany, sans-serif"><font size="4" style="font-size: 16pt;"><b>CONTENTS<br>
</b></font></font></p>
<a href="#mozTocId160097"></a>
<blockquote><a href="#mozTocId366745">OVERVIEW</a><br>
  <blockquote><a href="#mozTocId687086">Features</a><br>
    <a href="#mozTocId978040">Running JJack</a><br>
    <a href="#mozTocId894800">Developing JJack clients</a><br>
  </blockquote>
  <a href="#mozTocId38803">INSTALLATION</a><br>
  <br>
  <a href="#mozTocId948414">THE JJACK SHELL
APPLICATION
  </a><br>
  <blockquote><a href="#mozTocId11102">Synopsis</a><br>
    <a href="#mozTocId242219">Description</a><br>
    <a href="#mozTocId549182">Options</a><br>
    <a href="#mozTocId37044">Classpath</a><br>
    <a href="#mozTocId866414">Usage Example
    </a><br>
  </blockquote>
  <a href="#mozTocId265740">THE JJACK
SYSTEM WRAPPER APPLICATION
  </a><br>
  <blockquote><a href="#mozTocId843582">Synopsis</a><br>
    <a href="#mozTocId588095">Description</a><br>
    <a href="#mozTocId218423">Options</a><br>
    <a href="#mozTocId82740">Classpath</a><br>
    <a href="#mozTocId183830">Usage
Example
    </a><br>
  </blockquote>
  <a href="#mozTocId628724">JJACK SYSTEM
PROPERTIES</a><br>
  <blockquote><a href="#mozTocId305399">Synopsis</a><br>
    <a href="#mozTocId406065">Description</a><br>
  </blockquote>
  <a href="#mozTocId364583">ENVIRONMENT</a><br>
  <blockquote><a href="#mozTocId775866">JACK
Audio Connection Kit</a><br>
    <a href="#mozTocId73990">Java
Virtual Machine</a><br>
    <a href="#mozTocId470286">Classpath</a><br>
    <a href="#mozTocId393956">Library Path</a><br>
  </blockquote>
  <a href="#mozTocId805216">LIMITATIONS</a><br>
  <br>
  <a href="#mozTocId718144">SEE ALSO</a></blockquote>
</div>
</div>
<hr>
<h2><a name="mozTocId366745" class="mozTocH2"></a>OVERVIEW</h2>
<h3><a name="mozTocId687086" class="mozTocH3"></a>Features</h3>
  JJack is a <a href="http://www.jackaudio.org/">JACK</a> audio driver
  for the <a href="http://java.sun.com/products/java-media/sound/">Java Sound API</a>
  and a framework for the <a href="http://java.sun.com/">Java programming language</a>
  that allows Java applications to use the
  <a href="http://www.jackaudio.org/">JACK Audio Connection Kit</a>.<br>
<p style="margin-bottom: 0cm;">Audio processor clients can be designed to:<br>
</p>
<ul>
  <li><i>create</i> their own sounds (as a synthesizer or
sample-player)</li>
  <li><i>change</i> the sound-output of other clients (e.g. as an
effects-device)</li>
  <li><i>analyse</i> the audio streams generated by other clients (e.g.
display the wave form)</li>
</ul>
<h3><a name="mozTocId978040" class="mozTocH3"></a>Running JJack</h3>
There are <b>4 alternative ways</b> to run JJack:<br>
<ul>
  <li>As <b>Java Sound driver for JACK</b>:<br>
    By adding <code>lib/jjack.jar</code> to the classpath of any Java application,
    the Java Sound media subsystem automatically recognizes
    the driver and adds a JJack device to the list of available
    audio mixers. The native library <code>lib/i386/Linux/libjjack.so</code> (or according to your system)
    must previously be made accessible to Java, either by copying it to <code>/usr/lib/</code> (or according to your system),
    or by passing <code>-Djava.library.path=<jjack>/lib/i386/Linux</code> as parameter to the java runtime.<br>
    <br>
  </li>
  <li>Using the <b>JJack shell application:</b><br>
The <a href="#THE_JJACK_SHELL_APPLICATION">JJack shell application</a>
provides a simple way to configure and interconnect JJack clients, and
register a native JACK client to run the configured setting. See <a
 href="#THE_JJACK_SHELL_APPLICATION">documentation below.<br>
    </a><br>
  </li>
  <li>As <b>JavaBeans:</b><br>
JJack clients are usually designed to be visual JavaBeans
components, which e.g. allow editing their parameters using a graphical
user interface. Such JJack clients can be configured and be
interconnected to each other using any JavaBeans-compatible development
environment, e.g. Sun's <a
 href="http://java.sun.com/products/javabeans/beanbuilder/index.jsp">BeanBuilder</a>
application. (Note that depending on your system and configuration, the
development environment application must be started using the <a
 href="#THE_JJACK_SYSTEM_WRAPPER_APPLICATION_">JJackSystem wrapper</a>,
see <a href="#THE_JJACK_SYSTEM_WRAPPER_APPLICATION_">below</a>.)<br>
    <br>
  </li>
  <li>As <b>standalone application:</b><br>
A JJack client may implement a main-method which self-registers an
instance of the client at the JJack system and opens a window to
display its visual interface.<br>
  </li>
</ul>
<h3><a name="mozTocId894800" class="mozTocH3"></a>Developing JJack
clients</h3>
The document <a href="jjack-develop.html">Developing JJack Clients</a>
describes the basic steps to create new JJack clients.<br>
<p>For more details on the JJack API, refer to the <a
 href="api/index.html">Javadoc
API documentation</a>. To get a quick overview, see the <a
 href="uml/jjack.png">UML class diagram</a>.<br>
</p>
<h2><a name="mozTocId38803" class="mozTocH2"></a><a name="INSTALLATION"></a>INSTALLATION</h2>
<p>JJack uses the Java Native Interface (JNI) to access the JACK
daemon. Therefore, the native bridge library <tt>libjjack.so</tt> (on
Linux systems) needs to
be accessible by the Java Virtual Machine (JVM).<br>
There are two ways to make sure the JVM can load the native bridge
library:<br>
</p>
<ul>
  <li>Copy the file <tt>&lt;jjack-install-dir&gt;/lib/&lt;arch&gt;/&lt;os&gt;/*</tt>
to the system's default libarary path. On Linux:<br>
    <tt>cp ./lib/i386/Linux/libjjack.so /usr/lib/</tt><br>
Alternatively create a filesystem-link to the binary file at the
system's default library location:<br>
    <tt>cd /usr/lib<br>
ln -s &lt;jjack-install-dir&gt;/lib/i386/Linux/libjjack.so</tt></li>
  <li><i>Or</i> the library-path can directly be set through the JVM
system property <tt>java.library.path</tt>. Add parameter<br>
    <tt>-Djava.library.path=&lt;jjack-install-dir&gt;/lib/i386/Linux</tt>
to the invocation command.<tt><br>
    </tt></li>
</ul>
Note: The current version includes a pre-compiled binary library for
i386-Linux
only. To run JJack on different platforms, the source
files <tt>libjjack.c</tt> and <tt>libjjack.h</tt> need to be compiled
on your system. Please send a copy of the binray and a description of
your compilation process if you succeed in running JJack on different
platforms.<br>
<h2><a name="mozTocId948414" class="mozTocH2"></a><a
 name="THE_JJACK_SHELL_APPLICATION"></a>THE JJACK SHELL
APPLICATION<br>
</h2>
<h3><a name="mozTocId11102" class="mozTocH3"></a>Synopsis<code></code></h3>
<p><code><i>&lt;jre-binary and classpath&gt;</i> [ <a
 href="#JJACK_SYSTEM_PROPERTIES"><i>jjack-system-properties</i></a> ] </code><code>JJack
[ -i=<i>import-packages </i>] <i>client-chain </i></code><code><span
 style="font-style: normal;">| -help</span></code><code><br>
</code></p>
<p><span style="font-style: normal;"><span style="">with</span></span><code></code></p>
<p><code><i>client-chain</i>&nbsp; :=&nbsp; </code><code><i>client-class
</i>[ <i>parameters</i> ]
{ <i>monitor-chain</i> } </code><code>[ <i>client-chain</i> ]<br>
</code><span style="font-style: normal;"><code><i><br>
monitor-chain</i> :=&nbsp; <b>[</b> <i>monitor</i></code><code><i>-chain</i>-<i>members</i>
<b>]</b><br>
</code></span><span style="font-style: normal;"><span
 style="font-style: normal;"><code><i><br>
monitor-chain-members</i>&nbsp; :=&nbsp; <i>client-class</i></code></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><code><i>
</i>[ <i>parameters</i> ]</code></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><code><i>&nbsp;
</i><i>monitor-chain-members</i>&nbsp;
|&nbsp; <i>monitor-class</i></code></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><code><i>
</i>[ <i>parameters</i> ]</code></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><code></code><code><br>
</code></span>
</span></p>
<p><span style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><code><i>import-packages</i>&nbsp;
:=&nbsp; <i>package-name</i>{<b>,</b></code></span></span></span></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style="font-style: normal;"><span style=""><span
 style="font-style: normal;"><span style="font-style: normal;"><code><i>package-name</i></code></span></span></span></span></span></span></span></span></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><code>}<br>
</code></span></span></span></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style="font-style: normal;"><span style=""><span
 style="font-style: normal;"><span style="font-style: normal;"><code><i><br>
parameters</i>&nbsp;
:=&nbsp; <b>(</b><i>name</i>=<i>value</i>{<b>,</b></code></span></span></span></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style="font-style: normal;"><span style=""><span
 style="font-style: normal;"><span style="font-style: normal;"><code></code></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style="font-style: normal;"><span style=""><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style="font-style: normal;"><span style=""><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><code><i>name</i>=<i>value</i></code></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style="font-style: normal;"><span style=""><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><code></code></span></span></span></span></span></span></span></span></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><code>}<b>)</b></code></span></span></span></span></span></span></span></span></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><code></code><code><br>
</code></span>
</span></span></span></span></p>
<span style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><span style=""><tt><i>client-class</i> : </tt>Java
class that implements <tt>de.gulden.framework.jjack.JJackAudioProducer</tt></span></span></span>
<br>
</span></span></span><span style="font-style: normal;"><span
 style="font-style: normal;"><span style=""><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><span style=""><tt><i><br>
monitor-class</i> : </tt>Java class that implements <tt>de.gulden.framework.jjack.JJackAudioConsumer</tt></span></span></span><br>
</span></span></span><br>
</span></span></span>
<p><span style="font-style: normal;"><span style="font-style: normal;"><span
 style="">Mind the recursive definition of <tt><i>monitor-chain-members</i></tt>:
behind each member of a <tt>monitor-chain</tt> which is a <tt>client-class</tt>
(implementing <tt>JJackAudioProcuder</tt>), a new monitor chain can
again be started. However, any <tt>monitor-class</tt> ends a <tt>monitor-chain</tt>:
it is not possible to connect any more clients to a <tt>monitor-class</tt>,
because it only is a </span></span></span><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""><span style="font-style: normal;"><span
 style="font-style: normal;"><span style=""><tt>JJackAudioConsumer</tt></span></span></span></span></span></span><span
 style="font-style: normal;">.<br>
</span></p>
<p>(<tt>JJack</tt> is a Java class located in the 'default'
package of the class tree, without any preceeding package qualifier.
All it does is delegating the call to its main-method to <tt>de.gulden.application.jjack.JJack</tt>.<span
 style="font-style: normal;"><span style=""><tt> JJack</tt> exists for
shorter command line calls only.</span></span>)<br>
<span style="font-style: normal;"></span><span
 style="font-style: normal;"><span style="font-style: normal;"><span
 style=""></span></span></span></p>
<h3 class="western"><a name="mozTocId242219" class="mozTocH3"></a>Description</h3>
<p><span style="font-style: normal;"><b>JJack </b></span><span
 style="font-style: normal;">loads, displays
and runs Java-based JACK audio processing clients. Such a client is any
Java class that implements the interface
<code>de.gulden.framework.jjack.JJackAudioProcessor</code>, as provided
by the JJack
framework API.</span></p>
<p><span style="">These steps are performed when the JJack shell
application is run:<br>
</span></p>
<ul>
  <li><span style="">Initialize the JJack system and register one
native
JACK client (parameters passed via system-properties <tt>-Djjack.<i>xxx</i>=...</tt>).
    <br>
    </span></li>
  <li><span style="">Load classes given as client chain and monitor
chains and create object instances of these audio processors.<br>
    </span></li>
  <li><span style="">Connect the audio processors with event-listeners,
reflecting the order of processing specified by the client chain.</span></li>
  <li><span style="">Display the audio processors' graphical user
interfaces. Layouting is performed by placing members of a
client-chain horizontally from left to right, and by starting a new
monitor-chain vertically below the audio processor which is monitored.<br>
    </span></li>
  <li><span style=""></span>Connect the first audio processor in the
client chain to the JJackSystem. This starts audio-processing of the
complete tree of connected audio processors.<br>
  </li>
</ul>
<p><span style="font-style: normal;">A </span><a
 href="#USAGE%20EXAMPLE%7Coutline"><u><span style="font-style: normal;">usage
example</span></u></a><span style="font-style: normal;"> is given below.<br>
</span></p>
<p><span style="font-style: normal;">Note that there are alternative
ways to deploy JJack audio processors: <br>
</span></p>
<ul>
  <li><span style="font-style: normal;">Any JavaBeans-compatible
development environment should be
capable of handling JJack audio processors as JavaBeans. (Depending on
your system and configuration, it may be necessary to start the
development environment using the <a href="jjacksystem.html">JJackSystem
wrapper</a>.)</span></li>
</ul>
<h3 class="western"><a name="mozTocId549182" class="mozTocH3"></a>Options</h3>
<table width="100%" border="0" cellspacing="2" cellpadding="2">
  <tbody>
    <tr>
      <td valign="top"><tt>-c <i>&lt;filename&gt;</i></tt><br>
      </td>
      <td valign="top">Load options, client-chain and monitor-chains
from a file, instead of expecting them on the command line.<br>
      </td>
    </tr>
    <tr>
      <td nowrap="nowrap" valign="top"><tt>-i<i> &lt;package-name(s)&gt;<br>
      </i></tt></td>
      <td valign="top">Package name to search for client classes. This
allows shorter and better-readable specification of the client-chain
and monitor-chains. Multiple package names are to be seperated by
commas, without whitespace between them.<br>
      </td>
    </tr>
  </tbody>
</table>
<p>Additionally, the behaviour of the underlying native bridge to JACK
can be controlled by specifying <a href="jjackproperties.html">JJack
system properties</a>.<br>
</p>
<h3 class="western"><a name="mozTocId37044" class="mozTocH3"></a>Classpath</h3>
<a href="#Classpath__">See below</a>.<br>
<h3><a name="mozTocId866414" class="mozTocH3"></a>Usage Example<br>
</h3>
<p style="font-style: normal;">The following example runs the "Gain
control" JJack client (the current directory is assumed to be the JJack
install directory):</p>
<p><code><span style=""><font size="3">java
-Djava.library.path=lib/i386/Linux -cp
lib/jjack.jar:lib/jjack-clients.jar JJack
de.gulden.application.jjack.clients.Gain</font></span></code></p>
<p>The next example deploys the delay effect JJack client. The client
is configured to be a mono device, as set by the JJack system
properties -Djjack...=... The delay's time-parameter and
effects-intensity are specified in round brackets. After the
delay-effect, a monitor chain is started, indicated by square brackets.
The monitor-chain contains the oscilloscope client, which displays the
generated waveform.<br>
</p>
<p><span style=""><code><span style=""><font size="3">java
-Djava.library.path=lib/i386/Linux -Djjack.ports=1 -cp
lib/jjack.jar:lib/jjack-clients.jar JJack -i
de.gulden.application.jjack.clients "Delay(time=660,mixFx=30)" [
Oscilloscope ]<br>
</font></span></code></span></p>
<p><span style=""><span style="">(Mind the quotation marks around <code><i>"</i>Delay(..)<i>"</i></code>.
These are needed in a bash-shell to allow round brackets on the command
line.)<br>
</span></span></p>
<p><span style=""><span style="">The screenshot below shows the
configuration of an interconnected JJack client invoked by<br>
</span></span></p>
<p><code><span style=""><span style="">./jjack.sh -i
de.gulden.application.jjack.clients "Gain
[Oscilloscope(name=Oscilloscope-Client)] Delay
[Oscilloscope(name=Delay-Oscilloscope)]"</span></span></code></p>
<p><span style=""><span style="">The JJack client's input is connected
to the <code>xmms</code> audio-player, using the <code>qjackctl</code>
patchbay application:<br>
</span></span></p>
<p><span style=""><span style=""><img src="img/jjack_interconnect.png"
 alt="" width="600" height="450"><br>
</span></span></p>
<h2><a name="mozTocId265740" class="mozTocH2"></a><a
 name="THE_JJACK_SYSTEM_WRAPPER_APPLICATION_"></a>THE JJACK
SYSTEM WRAPPER APPLICATION<br>
</h2>
<h3><a name="mozTocId843582" class="mozTocH3"></a>Synopsis</h3>
<p><code><i>&lt;jre-binary and classpath&gt;</i> </code><code>[<i>&lt;jjack
system properties&gt;</i>] JJackSystem <i>&lt;wrapped main
application&gt; &lt;parameters of wrapped application&gt; </i></code><code><span
 style="font-style: normal;"> |
-help</span></code><code><br>
</code></p>
<p><span style="font-style: normal;"><span style="">In other words:
call any Java program as you would do without JJack, but insert <tt>JJackSystem</tt>
right before the original main class.</span></span></p>
<p><span style="font-style: normal;"><span style="">Applications that
originally use the <tt>-jar &lt;archive-file&gt;</tt> option of
the Java runtime-environment (JRE) must be invoked using the classic
mechanism instead, by naming the main class right after <tt>JJackSystem</tt>
and including the jar-archive in the classpath. (The main-class is
specified in the archive's MANIFEST entry.)</span></span></p>
<p><span style="font-style: normal;"><span style=""></span></span><span
 style="font-style: normal;"><span style="">(<tt>JJackSystem</tt>
is a Java class located in the default
package of the class tree, without any preceeding package qualifier.
All it does is delegating the call to its main-method to <tt>de.gulden.framework.jjack.JJackSystem</tt>.
<tt>JJackSystem</tt> exists for shorter command line calls only.)</span></span><code></code></p>
<h3 class="western"><a name="mozTocId588095" class="mozTocH3"></a>Description</h3>
<p><span style="">The JJackSystem wrapper initializes the
native parts of JJack and registers the underlying JACK client prior to
running any other Java program. Depending on the system platform and
configuration JJack is running on, such a wrapper is needed to access
the native side and register a JJack client without thread collision,
as
early as possible, before the JVM's main thread exits.<br>
</span></p>
<p style="margin-bottom: 0cm;">E.g., this allows to run JJack clients
as JavaBeans inside Sun's <a
 href="http://java.sun.com/products/javabeans/beanbuilder/index.jsp">BeanBuilder</a>,
see <a href="jjack-beanbuilder.html">Creating JJack clients with the
BeanBuilder</a>.<br>
<br>
</p>
<i>Note: Using the JJackSystem wrapper this way is supposed to be a
workaround.
Future versions of JJack / JACK should aim to make this obsolete. </i><br>
<p><span style="">These steps are performed when the JJackSystem
wrapper application is run:<br>
</span></p>
<ul>
  <li><span style="">Initialize and register one native
JACK client (parameters passed via system-properties <tt>-Djjack.xxx=...</tt>).
    <br>
    </span></li>
  <li><span style="">Load the class that is named right after <tt>JJackSystem</tt>
in the JRE call. This is the
wrapped class.<br>
    </span></li>
  <li><span style="">Run the wrapped class's main-method. All
parameters appearing after the name of the wrapped class are shifted </span><span
 style=""><span style="">one step </span></span><span style="">to the
left in order to appear as if passed directly from the JRE. The wrapped
application can now deal with JJack clients that comply the JavaBeans
specification.<br>
    </span></li>
</ul>
<p><span style="font-style: normal;">A </span><a
 href="#Usage_Example_-_Running_the_BeanBuilder_"><u><span
 style="font-style: normal;">usage
example</span></u></a><span style="font-style: normal;"> is given below.<br>
</span></p>
<p><span style="font-style: normal;">Note that class
<code>de.gulden.framework.jjack.JJackSystem</code> is not only an
application
wrapper, but implements the central native interface to the JACK
daemon.<br>
</span></p>
<h3 class="western"><a name="mozTocId218423" class="mozTocH3"></a>Options</h3>
None, except the general <a href="#JJACK_SYSTEM_PROPERTIES">JJack
system properties</a>. (Internally, the wrapped application and its
parameters are JJackSystem's options, but these are used to simulate
the direct invocation of the wrapped application. )<br>
<h3 class="western"><a name="mozTocId82740" class="mozTocH3"></a><a
 name="Classpath_"></a>Classpath</h3>
<a href="#Classpath_">See below</a>.<br>
<h3 class="western"><a name="mozTocId183830" class="mozTocH3"></a><a
 name="Usage_Example_-_Running_the_BeanBuilder_"></a>Usage
Example<br>
</h3>
<p>This example describes how to modify the original BeanBuilder
startup script to enable JJack support. See <a
 href="jjack-beanbuilder.html">Creating
JJack clients with the BeanBuilder</a>.<br>
</p>
<p>The BeanBuilder comes with a small default start script that looks
like this:<br>
</p>
<pre>#! /usr/bin/sh<br># Shell script to run the Bean Builder Application on 1.4 (and beyond)<br>#<br># Usage: JAVA_HOME=/usr/local/java/jdk1.3/solaris run.sh [-p palettefile] [-i] [filename.xml]<br>#<br># -where [-i] is interpret mode. Execute filename.xml without starting the Builder.<br># -where [filename.xml] load the archived xml file.<br># -where [-p palettefile] use "palettefile" as the Bean Builder palette<br># <br># Note: the -i and -p flags cannot be used simultaneously<br><br>CPATH=builder.jar:${JAVA_HOME}/lib/dt.jar:lib/jlfgr-1_0.jar<br><br>${JAVA_HOME}/bin/java -cp ${CPATH} Main $1 $2 $3 $4 $5</pre>
<p><br>
To manually prepare the BeanBuilder for deploying JJack clients, the
above script needs to be modified in 3 points.<br>
</p>
<p>1. adjust the classpath:</p>
In order to use JJack clients inside the BeanBuilder, the JJack API
classes must be present in the classpath. The script should be
changed like this:
<pre>JJACK_HOME=<i>&lt;jjack-install-dir&gt;</i><br>CPATH=builder.jar:${JAVA_HOME}/lib/dt.jar:lib/jlfgr-1_0.jar<b>:${JJACK_HOME}/lib/jjack.jar</b><br></pre>
<p>2. set native library path:</p>
<p>The JVM must be told where to look for native library files. If you
did not <a
 href="jjack.html#INSTALLATION">install</a>
the JJack native library <tt>libjjack.so</tt>
into your system's default library path (by copying or linking <code>libjjack.so</code>
there), set the Java system property<tt>
java.library.path</tt> to the desired directory:</p>
<pre>${JAVA_HOME}/bin/java -cp ${CPATH} <b>-Djava.library.path=${JJACK_HOME}/lib/i386/Linux</b> Main $1 $2 $3 $4 $5</pre>
<p>3. add the JJackSystem wrapper in front of the main-class call:<br>
</p>
<p>On some systems and configurations, it is necessary to make sure
that JJack's native JACK client is allocated as early as possible,
before
program execution branches into child-threads. If you need this, place
the wrapper application <tt>JJackSystem</tt> right before the original
main class name in the command line:</p>
<pre>${JAVA_HOME}/bin/java -cp ${CPATH} <b>-Djava.library.path=${JJACK_HOME}/lib/i386/Linux JJackSystem</b> Main $1 $2 $3 $4 $5<br></pre>
When the BeanBuilder has started, choose "Load Jar..." from the file
menu and select <tt>&lt;jjack-install-dir&gt;/lib/jjack-beans.jar</tt>
to make the JJack clients known to the BeanBuilder as JavaBeans. Then
you can work with the JJack clients as with any other JavaBean. By
using the add/remove-Monitor and add/remove-Chained event-listener
methods, complex interactions of JJack clients can be constructed. See <a
 href="jjack-beanbuilder.html">Creating
JJack clients with the BeanBuilder</a> for more details.
<h2 class="western"><a name="mozTocId628724" class="mozTocH2"></a><a
 name="JJACK_SYSTEM_PROPERTIES"></a>JJACK SYSTEM
PROPERTIES</h2>
<h3><a name="mozTocId305399" class="mozTocH3"></a>Synopsis<code></code></h3>
<p><code><i>&lt;jre-binary and options&gt;</i> <b>-D<i>&lt;property&gt;</i>=<i>&lt;value&gt;</i>
</b></code><b><code>-D<i>&lt;property&gt;</i>=<i>&lt;value&gt;</i></code><code>
... </code></b><code></code><code><i>&lt;application-and-options&gt;</i>
...</code><code></code><code></code></p>
<p><code></code></p>
<p style="font-style: normal;">The JJack system properties are passed
to the Java virtual machine by using the <b>-D</b> flag on the command
line. Mind
that these options have to occur <b>before</b> the name of the Java
class invoked.<br>
</p>
<h3><a name="mozTocId406065" class="mozTocH3"></a>Description</h3>
JJack system properties control the behaviour of
the underlying JJack system. They take effect when the JJack system
registers as a native JACK client at the JACK daemon <tt>jackd</tt>.<br>
<p style="font-style: normal;"></p>
<table cellpadding="2" cellspacing="2" border="0" width="100%">
  <tbody>
    <tr>
      <td valign="top"><tt>-Djjack.client.name=<i>name</i></tt></td>
      <td valign="top">Name of native JACK client to register.<br>
      </td>
    </tr>
    <tr>
      <td valign="top"><tt>-Djjack.ports=<i>n</i></tt></td>
      <td valign="top">Number of input and output ports to be used.
Default: 2 (stereo)<br>
      </td>
    </tr>
    <tr>
      <td valign="top"><tt>-Djjack.ports.input=<i>n</i></tt></td>
      <td valign="top">Number of input ports to be used, if different
from output ports.</td>
    </tr>
    <tr>
      <td valign="top"><tt>-Djjack.ports.output=<i>n</i></tt></td>
      <td valign="top">Number of output ports to be used, if different
from input ports.</td>
    </tr>
    <tr>
      <td valign="top"><tt>-Djjack.ports.autoconnect=true|false</tt></td>
      <td valign="top">Sets whether to connect both input and output
ports to physical JACK ports.<br>
      </td>
    </tr>
    <tr>
      <td valign="top"><tt>-Djjack.ports.input.autoconnect=true|false</tt></td>
      <td valign="top">Sets whether to connect the input ports to
physical JACK ports.</td>
    </tr>
    <tr>
      <td valign="top"><tt>-Djjack.ports.output.autoconnect=true|false</tt></td>
      <td valign="top">Sets whether to connect the output ports to
physical JACK ports.</td>
    </tr>
  </tbody>
</table>
<br>
<h2 class="western"><a name="mozTocId364583" class="mozTocH2"></a><a
 name="ENVIRONMENT"></a>ENVIRONMENT</h2>
<h3><a name="mozTocId775866" class="mozTocH3"></a>JACK
Audio Connection Kit</h3>
<p>The current version of JJack has been tested with <code>jackd</code>
version 0.9.4 on a Debian 3.0 Linux system (version 0.80.0 of <code>libjack.so</code>).
Other versions or operating systems may or may not work.
(Please send a mail about your experience with another OS, especially
MacOS. Note that for use with platforms other than i386-Linux, the
native bridge library <code>libjjack.so</code>
needs to be compiled from the source files <code>libjjack.c</code>
and <code>libjjack.h</code> first.)<br>
</p>
<p>The testing environment's JACK daemon had been started manually from
an ordinary user account with access to the audio device by entering<br>
</p>
<p><tt>jackd -v -d alsa -d hw:0 -r 44100 -s<br>
</tt><br>
There are many alternative ways for starting <code>jackd</code>, see
the <a href="http://www.djcj.org/LAU/jack/">JACK user documentation</a>
for details.<tt><br>
</tt></p>
<h3 class="western"><a name="mozTocId73990" class="mozTocH3"></a>Java
Virtual Machine</h3>
<p><b>Java Runtime Environment Version 1.4 (or higher) is required</b> to run
JJack. This version newly introduces the memory mapped direct <a
 href="http://java.sun.com/j2se/1.4.2/docs/guide/jni/jni-14.html"><tt>java.nio.ByteBuffer</tt></a>
class, which JJack makes intensive use of.<br>
</p>
<h3 class="western"><a name="mozTocId470286" class="mozTocH3"></a><a
 name="Classpath__"></a>Classpath</h3>
<p style="font-style: normal;">In order to run JJack, the following
components are needed in the classpath:<br>
</p>
<ul>
  <li>Archive <tt>&lt;JJack-install-dir&gt;/lib/jjack.jar</tt>,
which contains the framework API classes and the JJack shell
application. This is <b>always</b> needed in the classpath when JJack
clients are used.<br>
    <br>
  </li>
  <li>Archive <tt>&lt;JJack-install-dir&gt;/lib/jjack-beans.jar</tt>
for examples audio processors. The MANIFEST entry in this archive
declares which classes can be used as JavaBeans, so this .jar-file can
be directly loaded by JavaBean-compatbile development environments. If
you use these classes in such a JavaBean-environment, do <i>not</i>
include this archive in the classpath but load it via the application's
facilities. <br>
Otherwise, if these example clients are to be run via the <a
 href="#THE_JJACK_SHELL_APPLICATION">JJack shell application</a>, <i>do</i>
include them in the classpath.<br>
    <br>
  </li>
  <li>Any additional components containing more audio processors to be
run, for example more JavaBean-archives.</li>
</ul>
<h3><a name="mozTocId393956" class="mozTocH3"></a><a name="Library_Path"></a>Library
Path</h3>
The JVM must be told where to look for native library files. If you
did not <a
 href="jjack.html#INSTALLATION">install</a>
the JJack native library <tt>libjjack.so</tt>
into your system's default library path (by copying or linking <code>libjjack.so</code>
there), set the Java system property<tt>
java.library.path</tt> to the desired directory:
<pre>${JAVA_HOME}/bin/java ... <b>-Djava.library.path=${JJACK_HOME}/lib/i386/Linux</b> ...</pre>
<p style="font-style: normal;">
</p>
<span style="font-style: normal;"></span>
<h2><a name="mozTocId805216" class="mozTocH2"></a>LIMITATIONS</h2>
<p>Some limitations and bugs apply to the current version:</p>
<ul>
  <li> Client shutdown is not explicitly told to jackd, so the
allocated client gets "zombified" by jackd when it shuts down.</li>
  <li>Not all of JACK's features are reflected in the JJack API, e. g.
dynamic change of the sample rate cannot be reported to the Java
application.<br>
  </li>
  <li> Needs far more testing on different platforms.<br>
  </li>
</ul>
<h2 class="western"><a name="mozTocId718144" class="mozTocH2"></a>SEE
ALSO</h2>
<p style="text-decoration: none;"><a
 href="http://www.jackaudio.org/">JACK Audio Connection Kit</a><br>
<br>
<a href="http://www.djcj.org/LAU/jack/">JACK user documentation</a><br>
<br>
<a href="http://java.sun.com/products/javabeans/beanbuilder/index.jsp">Java
BeanBuilder</a>
</p>
<p style="text-decoration: none;"><a
 href="http://java.sun.com/products/javabeans/">JavaBeans Specification</a><br>
</p>
<a href="http://java.sun.com/j2se/1.4.2/docs/guide/jni/jni-14.html">Java
Native Interface Extensions introduced in Version 1.4 of the Java2 SDK</a><br>
<div align="left">
<p><a
 href="http://java.sun.com/j2se/1.4.2/docs/api/java/nio/FloatBuffer.html">Class
<code>java.nio.FloatBuffer</code></a></p>
</div>
<p align="right"><small><small><font size="2"><small><small>Copyright
&copy; Jens Gulden and others 2004-2007<br>
Licensed under the LGPL.<br>
</small></small></font></small></small></p>
</body>
</html>
